!function(e,t,i){var n=window.siteoriginPanels;n.view.styles=Backbone.View.extend({stylesLoaded:!1,initialize:function(){},render:function(n,s,l){if("undefined"==typeof n)return!1;l=t.extend({builderType:""},l),this.$el.addClass("so-visual-styles");var o=this;e.post(i.ajaxurl,{action:"so_panels_style_form",type:n,style:this.model.get("style"),args:JSON.stringify(l),postId:s},function(e){o.$el.html(e),o.setupFields(),o.stylesLoaded=!0,o.trigger("styles_loaded")})},attach:function(e){e.append(this.$el)},detach:function(){this.$el.detach()},setupFields:function(){this.$(".style-section-wrapper").each(function(){var t=e(this);t.find(".style-section-head").click(function(e){e.preventDefault(),t.find(".style-section-fields").slideToggle("fast")})}),"undefined"!=typeof e.fn.wpColorPicker&&("object"!=typeof i.wpColorPickerOptions.palettes||jQuery.isArray(i.wpColorPickerOptions.palettes)||(i.wpColorPickerOptions.palettes=e.map(i.wpColorPickerOptions.palettes,function(e){return e})),this.$(".so-wp-color-field").wpColorPicker(soPanelsOptions.wpColorPickerOptions)),this.$(".style-field-image").each(function(){var t=null,i=e(this);i.find(".so-image-selector").click(function(e){e.preventDefault(),null===t&&(t=wp.media({title:"choose",library:{type:"image"},button:{text:"Done",close:!0}}),t.on("select",function(){var e=t.state().get("selection").first().attributes;try{i.find(".current-image").css("background-image","url("+e.sizes.thumbnail.url+")")}catch(n){i.find(".current-image").css("background-image","url("+e.sizes.full.url+")")}i.find("input").val(e.id)})),t.open()}),i.find(".remove-image").click(function(e){e.preventDefault(),i.find(".current-image").css("background-image","none"),i.find("input").val("")})}),this.$(".style-field-measurement").each(function(){var t=e(this),i=t.find('input[type="text"]'),n=t.find("select"),s=t.find('input[type="hidden"]');if(""!==s.val()){var l=/(?:([0-9\.,]+)(.*))+/,o=s.val().split(" "),a=[];for(var r in o){var c=l.exec(o[r]);null!=c&&"undefined"!=typeof c[1]&&"undefined"!=typeof c[2]&&(a.push(c[1]),n.val(c[2]))}i.val(a.join(" "))}var u=function(){var e=i.val().split(" ").filter(function(e){return""!==e}).map(function(e){return e+n.val()}).join(" ");s.val(e)};i.keyup(u).change(u),n.change(u)})}})}(jQuery,_,soPanelsOptions);